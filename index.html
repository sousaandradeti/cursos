<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Confirma칞칚o de Curso</title>

<style>
    body { font-family: Arial; background:#f7f7f7; padding:40px; }
    .box { background:white; max-width:400px; margin:auto; padding:30px; border-radius:10px; box-shadow:0 0 10px #00000015; }
    h2 { text-align:center; }
    input, button{
        width:100%; padding:12px; margin-top:10px; border-radius:6px; font-size:16px;
    }
    button{ background:#0176ff; color:white; cursor:pointer; border:none;}
    button:hover{ background:#005ad1; }

    /* --- Estilos para o Seletor de Emojis (Rating) --- */
    .rating-box {
        display: flex;
        justify-content: center;
        direction: rtl; /* Inverte a ordem para que o 5 fique  direita */
        margin: 15px 0;
    }

    .rating-box input[type="radio"] {
        display: none;
    }

    .rating-box label {
        font-size: 40px;
        color: #ccc; 
        cursor: pointer;
        padding: 0 5px;
        transition: color 0.2s, transform 0.2s;
        position: relative; 
    }

    /* Define os emojis para cada ponto */
    .rating-box label[for="star5"]::before { content: '游'; }
    .rating-box label[for="star4"]::before { content: '游뗵'; }
    .rating-box label[for="star3"]::before { content: '游땛'; }
    .rating-box label[for="star2"]::before { content: '游뗴'; }
    .rating-box label[for="star1"]::before { content: '游'; }

    /* Efeito de hover e sele칞칚o */
    .rating-box label:hover,
    .rating-box label:hover ~ label,
    .rating-box input[type="radio"]:checked ~ label {
        color: #ffc107;
        transform: scale(1.1);
    }

    .rating-box input[type="radio"]:checked + label {
        color: #ff9800;
    }

    /* Estilo para o check de sele칞칚o */
    .rating-box input[type="radio"]:checked + label::after {
        content: '\2713'; 
        position: absolute;
        bottom: -15px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #28a745;
        color: white;
        font-size: 14px;
        line-height: 1;
        padding: 3px 6px;
        border-radius: 50%;
        z-index: 10;
        box-shadow: 0 0 5px rgba(0,0,0,0.3);
    }
</style>
</head>
<body>

<div class="box">
    <h2>Cursos Sousa Andrade Academy</h2>

    <form method="POST" action="https://script.google.com/macros/s/AKfycbyxJcX4G0468ooL8qKWKZEUJgVFH2z9jtwbdNeDCht2Fnx_Y7MbWUEy9T-ZkCg_d9j5/exec">
        <input type="text" name="nome" placeholder="Seu nome" required>
        <input type="email" name="email" placeholder="Seu email" required>
        <input type="hidden" name="curso" id="curso">
        
        <div id="rating-section"> 
            <label id="course-label" style="margin-top: 15px; display: block;">Sua Avalia칞칚o do Curso:</label>
            <div class="rating-box">
                <input type="radio" id="star5" name="nota" value="5" required />
                <label for="star5" title="Excelente (5)"></label>

                <input type="radio" id="star4" name="nota" value="4" />
                <label for="star4" title="Bom (4)"></label>

                <input type="radio" id="star3" name="nota" value="3" />
                <label for="star3" title="Razo치vel (3)"></label>

                <input type="radio" id="star2" name="nota" value="2" />
                <label for="star2" title="Ruim (2)"></label>

                <input type="radio" id="star1" name="nota" value="1" />
                <label for="star1" title="Muito Ruim (1)"></label>
            </div>
        </div>

        <input type="hidden" name="status" id="status">
        
        <button type="submit">Concluir</button>
    </form>
</div>

<script>
    // Usa o objeto URLSearchParams para ler os par칙metros
    const p = new URLSearchParams(window.location.search);
    const courseLabel = document.getElementById("course-label");
    const ratingSection = document.getElementById("rating-section"); 
    const notaInputs = document.querySelectorAll('input[name="nota"]');
    
    // --- Fun칞칚o Simples de Capitaliza칞칚o ---
    function capitalizeFirstLetter(string) {
        if (!string) return '';
        string = string.toLowerCase();
        return string.charAt(0).toUpperCase() + string.slice(1);
    }
    // ----------------------------------------
    
    // --- 1. L칩gica para o Curso ---
    let cursoValue = p.get("curso");
    
    if (cursoValue) {
        let displayName = cursoValue.replace(/_/g, ' ');
        displayName = displayName.split(' ').map((word, index) => {
            return (index === 0) ? capitalizeFirstLetter(word) : word;
        }).join(' ');
        
        document.getElementById("curso").value = cursoValue;
        courseLabel.textContent = `Sua Avalia칞칚o do Curso: ${displayName}`;
        console.log("Curso lido e formatado para exibi칞칚o:", displayName);
    } else {
        courseLabel.textContent = "Sua Avalia칞칚o do Curso:";
        console.warn("Par칙metro 'curso' ausente na URL. Usando texto padr칚o.");
    }

    // --- 2. L칩gica para o Status e Avalia칞칚o ---
    const statusValue = p.get("status");
    document.getElementById("status").value = statusValue || "";

    // Se o status for "iniciado" (case-insensitive)
    if (statusValue && statusValue.toLowerCase() === "iniciado") {
        
        // Esconde toda a se칞칚o de avalia칞칚o
        ratingSection.style.display = 'none';
        console.log("Status 'iniciado' detectado. Avalia칞칚o ocultada.");

        // Remove o atributo 'required' dos inputs de nota para permitir a submiss칚o
        notaInputs.forEach(input => {
            input.removeAttribute('required');
        });

    } else {
        // Para status vazio ou qualquer outro valor, a avalia칞칚o permanece vis칤vel
        ratingSection.style.display = 'block';
        console.log("Status n칚o 칠 'iniciado' ou est치 ausente. Avalia칞칚o vis칤vel.");

        // Garante que o atributo 'required' esteja presente
        notaInputs.forEach(input => {
            input.setAttribute('required', 'required');
        });
    }

    console.log("Status final lido da URL:", statusValue);
</script>

</body>
</html>
